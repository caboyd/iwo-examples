{"version":3,"file":"Mesh.js","sources":["../../../../iwo/src/meshes/Mesh.ts"],"sourcesContent":["/*\r\n    Base Mesh Class\r\n    A Mesh Contains:\r\n            \r\n */\r\n\r\nimport { Geometry } from \"geometry/Geometry\";\r\nimport { DrawMode } from \"graphics/WebglConstants\";\r\nimport { IndexBuffer } from \"graphics/IndexBuffer\";\r\nimport { VertexBuffer } from \"graphics/VertexBuffer\";\r\nimport { SubMesh } from \"./SubMesh\";\r\n\r\nexport class Mesh {\r\n    public readonly index_buffer: IndexBuffer | undefined;\r\n    public readonly vertex_buffer: VertexBuffer;\r\n\r\n    public draw_mode: DrawMode;\r\n    public readonly sub_meshes: SubMesh[];\r\n    public count: number;\r\n\r\n    public constructor(gl: WebGL2RenderingContext, geometry: Geometry) {\r\n        if (geometry.indices) this.index_buffer = new IndexBuffer(gl, geometry);\r\n        this.vertex_buffer = new VertexBuffer(gl, geometry);\r\n        this.sub_meshes = [];\r\n        this.draw_mode = DrawMode.TRIANGLES;\r\n        this.count = 0;\r\n\r\n        for (const group of geometry.groups) {\r\n            this.count += group.count;\r\n            this.sub_meshes.push(\r\n                new SubMesh(group.material_index, group.offset, group.count, this.vertex_buffer, this.index_buffer)\r\n            );\r\n        }\r\n    }\r\n\r\n    public setDrawMode(mode: DrawMode): void {\r\n        this.draw_mode = mode;\r\n    }\r\n\r\n    public destroy(gl: WebGL2RenderingContext): void {\r\n        for (const sub_mesh of this.sub_meshes) {\r\n            sub_mesh.destroy();\r\n        }\r\n\r\n        if (this.index_buffer) this.index_buffer.destroy(gl);\r\n        this.vertex_buffer.destroy(gl);\r\n    }\r\n}\r\n"],"names":["IndexBuffer","VertexBuffer","SubMesh"],"mappings":";;;;AAAA;;;;;MAYa,IAAI;IAQb,YAAmB,EAA0B,EAAE,QAAkB;QAC7D,IAAI,QAAQ,CAAC,OAAO;YAAE,IAAI,CAAC,YAAY,GAAG,IAAIA,aAAW,CAAC,EAAE,EAAE,QAAQ,CAAC,CAAC;QACxE,IAAI,CAAC,aAAa,GAAG,IAAIC,cAAY,CAAC,EAAE,EAAE,QAAQ,CAAC,CAAC;QACpD,IAAI,CAAC,UAAU,GAAG,EAAE,CAAC;QACrB,IAAI,CAAC,SAAS,qBAAsB;QACpC,IAAI,CAAC,KAAK,GAAG,CAAC,CAAC;QAEf,KAAK,MAAM,KAAK,IAAI,QAAQ,CAAC,MAAM,EAAE;YACjC,IAAI,CAAC,KAAK,IAAI,KAAK,CAAC,KAAK,CAAC;YAC1B,IAAI,CAAC,UAAU,CAAC,IAAI,CAChB,IAAIC,SAAO,CAAC,KAAK,CAAC,cAAc,EAAE,KAAK,CAAC,MAAM,EAAE,KAAK,CAAC,KAAK,EAAE,IAAI,CAAC,aAAa,EAAE,IAAI,CAAC,YAAY,CAAC,CACtG,CAAC;SACL;KACJ;IAEM,WAAW,CAAC,IAAc;QAC7B,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC;KACzB;IAEM,OAAO,CAAC,EAA0B;QACrC,KAAK,MAAM,QAAQ,IAAI,IAAI,CAAC,UAAU,EAAE;YACpC,QAAQ,CAAC,OAAO,EAAE,CAAC;SACtB;QAED,IAAI,IAAI,CAAC,YAAY;YAAE,IAAI,CAAC,YAAY,CAAC,OAAO,CAAC,EAAE,CAAC,CAAC;QACrD,IAAI,CAAC,aAAa,CAAC,OAAO,CAAC,EAAE,CAAC,CAAC;KAClC;;;;;"}