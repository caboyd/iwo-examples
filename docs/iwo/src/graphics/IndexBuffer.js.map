{"version":3,"file":"IndexBuffer.js","sources":["../../../../iwo/src/graphics/IndexBuffer.ts"],"sourcesContent":["import { Geometry } from \"geometry/Geometry\";\r\nimport { ReferenceCounter } from \"helpers/ReferenceCounter\";\r\nimport { WebGL } from \"./WebglHelper\";\r\n\r\nexport class IndexBuffer {\r\n    public readonly EBO: WebGLBuffer;\r\n    public readonly indices: Uint16Array | Uint32Array;\r\n    public readonly references: ReferenceCounter;\r\n\r\n    public constructor(gl: WebGL2RenderingContext, geometry: Geometry) {\r\n        if (geometry.indices === undefined) throw new Error(\"Geometry has no indices.\");\r\n        this.EBO = WebGL.buildBuffer(gl, gl.ELEMENT_ARRAY_BUFFER, geometry.indices);\r\n        this.indices = geometry.indices;\r\n        this.references = new ReferenceCounter();\r\n    }\r\n\r\n    public bind(gl: WebGL2RenderingContext): void {\r\n        gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, this.EBO);\r\n    }\r\n\r\n    public destroy(gl: WebGL2RenderingContext): void {\r\n        if (this.references.count !== 0) {\r\n            console.warn(this);\r\n            console.warn(\"Can't destroy while still being referenced\");\r\n        } else {\r\n            gl.deleteBuffer(this.EBO);\r\n        }\r\n    }\r\n}\r\n"],"names":["ReferenceCounter"],"mappings":";;;MAIa,WAAW;IAKpB,YAAmB,EAA0B,EAAE,QAAkB;QAC7D,IAAI,QAAQ,CAAC,OAAO,KAAK,SAAS;YAAE,MAAM,IAAI,KAAK,CAAC,0BAA0B,CAAC,CAAC;QAChF,IAAI,CAAC,GAAG,GAAG,KAAK,CAAC,WAAW,CAAC,EAAE,EAAE,EAAE,CAAC,oBAAoB,EAAE,QAAQ,CAAC,OAAO,CAAC,CAAC;QAC5E,IAAI,CAAC,OAAO,GAAG,QAAQ,CAAC,OAAO,CAAC;QAChC,IAAI,CAAC,UAAU,GAAG,IAAIA,kBAAgB,EAAE,CAAC;KAC5C;IAEM,IAAI,CAAC,EAA0B;QAClC,EAAE,CAAC,UAAU,CAAC,EAAE,CAAC,oBAAoB,EAAE,IAAI,CAAC,GAAG,CAAC,CAAC;KACpD;IAEM,OAAO,CAAC,EAA0B;QACrC,IAAI,IAAI,CAAC,UAAU,CAAC,KAAK,KAAK,CAAC,EAAE;YAC7B,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;YACnB,OAAO,CAAC,IAAI,CAAC,4CAA4C,CAAC,CAAC;SAC9D;aAAM;YACH,EAAE,CAAC,YAAY,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;SAC7B;KACJ;;;;;"}